import{_ as f,c as n,a as y,b as e,d as m,t as r,F as h,r as g,o as c,e as p,n as u,f as w,g as b}from"./index-BFPoeHg0.js";const x={name:"OrderDetailModal",props:{show:{type:Boolean,required:!0},order:{type:Object,default:null}},emits:["close"],methods:{formatDate(s){if(!s)return"";const t=new Date(s);return t.toLocaleDateString("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit"})+" "+t.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})},formatCurrency(s){return s==null||isNaN(s)?"0,00 ₺":new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:2,maximumFractionDigits:2}).format(s)},getOrderStatusText(s){switch(s){case 1:return"Yeni siparişler";case 2:return"Hazırlanan siparişler";case 3:return"Kargolanan siparişler";case 4:return"İptal/değişim/iade Siparişleri";case 5:return"İptal edilen Siparişler";default:return"Bilinmeyen durum"}}}},k={key:0,class:"modal fade show d-block",tabindex:"-1",style:{"background-color":"rgba(0, 0, 0, 0.5)"}},T={class:"modal-dialog modal-xl modal-dialog-centered"},S={class:"modal-content shadow-lg border-0 rounded-4"},D={class:"modal-header bg-primary text-white rounded-top-4"},O={key:0,class:"modal-body"},C={class:"p-3 mb-3 bg-light rounded shadow-sm"},P={class:"row"},M={class:"col-md-3"},N={class:"fw-bold"},L={class:"col-md-3"},F={class:"col-md-3"},R={class:"badge bg-info text-dark"},z={class:"col-md-3"},A={class:"badge bg-success fs-6"},I={class:"p-3 mb-3 rounded border"},B={class:"row"},V={class:"col-md-4"},Y={class:"col-md-4"},j={class:"col-md-4"},q={class:"p-3 mb-3 rounded border bg-white"},K={class:"mb-0"},E={class:"mb-0"},G={class:"table-responsive shadow-sm rounded"},H={class:"table table-bordered table-hover align-middle"},J={class:"fw-semibold"},Q={class:"fw-bold text-end"},U={class:"table-light"},W={class:"fw-bold text-end"},X={class:"modal-footer bg-light rounded-bottom-4"};function Z(s,t,l,_,d,o){return l.show?(c(),n("div",k,[e("div",T,[e("div",S,[e("div",D,[t[2]||(t[2]=e("h5",{class:"modal-title fw-bold"},[e("i",{class:"bi bi-receipt me-2"}),m(" Sipariş Detayı ")],-1)),e("button",{type:"button",class:"btn-close btn-close-white",onClick:t[0]||(t[0]=i=>s.$emit("close"))})]),l.order?(c(),n("div",O,[e("div",C,[e("div",P,[e("div",M,[t[3]||(t[3]=e("small",{class:"text-muted d-block"},"Sipariş No",-1)),e("span",N,r(l.order.order.code),1)]),e("div",L,[t[4]||(t[4]=e("small",{class:"text-muted d-block"},"Tarih",-1)),e("span",null,r(o.formatDate(l.order.order.createdAt)),1)]),e("div",F,[t[5]||(t[5]=e("small",{class:"text-muted d-block"},"Durum",-1)),e("span",R,r(o.getOrderStatusText(l.order.order.status)),1)]),e("div",z,[t[6]||(t[6]=e("small",{class:"text-muted d-block"},"Toplam",-1)),e("span",A,r(o.formatCurrency(l.order.summary.overall)),1)])])]),e("div",I,[t[10]||(t[10]=e("h6",{class:"fw-bold mb-2"},[e("i",{class:"bi bi-person me-1"}),m(" Müşteri Bilgileri")],-1)),e("div",B,[e("div",V,[t[7]||(t[7]=e("small",{class:"text-muted d-block"},"Ad Soyad",-1)),e("span",null,r(l.order.customer.name),1)]),e("div",Y,[t[8]||(t[8]=e("small",{class:"text-muted d-block"},"E-posta",-1)),e("span",null,r(l.order.customer.email),1)]),e("div",j,[t[9]||(t[9]=e("small",{class:"text-muted d-block"},"Telefon",-1)),e("span",null,r(l.order.customer.phone),1)])])]),e("div",q,[t[11]||(t[11]=e("h6",{class:"fw-bold mb-2"},[e("i",{class:"bi bi-geo-alt me-1"}),m(" Teslimat Adresi")],-1)),e("p",K,r(l.order.customer.delivery.address)+", "+r(l.order.customer.delivery.district)+", "+r(l.order.customer.delivery.city),1),t[12]||(t[12]=e("hr",{class:"my-2"},null,-1)),t[13]||(t[13]=e("h6",{class:"fw-bold mb-2"},[e("i",{class:"bi bi-receipt me-1"}),m(" Fatura Adresi")],-1)),e("p",E,r(l.order.customer.invoice.address)+", "+r(l.order.customer.invoice.district)+", "+r(l.order.customer.invoice.city),1)]),t[16]||(t[16]=e("h6",{class:"fw-bold mb-2"},[e("i",{class:"bi bi-box-seam me-1"}),m(" Ürünler")],-1)),e("div",G,[e("table",H,[t[15]||(t[15]=e("thead",{class:"table-primary"},[e("tr",null,[e("th",null,"Kod"),e("th",null,"Ürün Adı"),e("th",null,"Miktar"),e("th",null,"Birim Fiyat"),e("th",null,"Toplam")])],-1)),e("tbody",null,[(c(!0),n(h,null,g(l.order.products,i=>(c(),n("tr",{key:i.code},[e("td",null,[e("code",null,r(i.code),1)]),e("td",J,r(i.name),1),e("td",null,"x"+r(i.quantity),1),e("td",null,r(o.formatCurrency(i.price+i.price/10)),1),e("td",Q,r(o.formatCurrency(Math.ceil((i.price+i.price/10)*i.quantity))),1)]))),128))]),e("tfoot",null,[e("tr",U,[t[14]||(t[14]=e("td",{colspan:"4",class:"text-end fw-bold"},"Genel Toplam:",-1)),e("td",W,r(o.formatCurrency(l.order.summary.overall)),1)])])])])])):y("",!0),e("div",X,[e("button",{class:"btn btn-outline-secondary",onClick:t[1]||(t[1]=i=>s.$emit("close"))}," Kapat ")])])])])):y("",!0)}const $=f(x,[["render",Z],["__scopeId","data-v-df4890ee"]]),ee={name:"Siparislerim",components:{OrderDetailModal:$},data(){return{orders:[],currentPage:0,pageSize:10,totalOrders:0,isLoading:!1,showModal:!1,selectedOrder:null,bayiId:localStorage.getItem("bayi_id")}},computed:{totalPages(){return Math.ceil(this.totalOrders/this.pageSize)},totalAmount(){return this.orders.reduce((s,t)=>s+(t.summary?.overall||0),0)}},methods:{async fetchOrders(){try{this.isLoading=!0;const s=await b.get(`api/siparisler/by-user/${this.bayiId}?page=${this.currentPage}&pageSize=${this.pageSize}`);if(this.orders=s.data,this.totalOrders===0){const t=await b.get(`api/siparisler/by-user/${this.bayiId}/count`);this.totalOrders=t.data}}catch(s){console.error("Siparişler alınamadı:",s)}finally{this.isLoading=!1}},async fetchOrdersOnly(){try{this.isLoading=!0;const s=await b.get(`api/siparisler/by-user/${this.bayiId}?page=${this.currentPage}&pageSize=${this.pageSize}`);this.orders=s.data}catch(s){console.error("Siparişler alınamadı:",s)}finally{this.isLoading=!1}},goToPage(s){s<0||s>=this.totalPages||(this.currentPage=s,this.fetchOrdersOnly())},formatDate(s){if(!s)return"";const t=new Date(s);return t.toLocaleDateString("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit"})+" "+t.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})},formatCurrency(s){return s==null||isNaN(s)?"0,00 ₺":new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:2,maximumFractionDigits:2}).format(s)},openModal(s){this.selectedOrder=s,this.showModal=!0},closeModal(){this.showModal=!1,this.selectedOrder=null}},mounted(){this.fetchOrders()}},te={class:"dashboard-container p-4"},se={class:"summary-cards mb-4 d-flex flex-wrap gap-3"},re={class:"card bg-primary text-white p-3 rounded shadow",style:{"min-width":"180px"}},le={class:"fs-3"},oe={class:"card bg-success text-white p-3 rounded shadow",style:{"min-width":"180px"}},ie={class:"fs-3"},ae={key:0,class:"d-flex justify-content-center align-items-center py-5"},de={key:1},ne={class:"table-responsive rounded shadow"},ce={class:"table table-bordered table-hover"},me={class:"font-monospace"},ue={class:"fw-semibold"},be=["onClick"],he={class:"d-flex justify-content-center mt-3"},ge={class:"pagination"},ye=["onClick"];function fe(s,t,l,_,d,o){const i=w("OrderDetailModal");return c(),n("div",te,[t[6]||(t[6]=e("h1",{class:"text-2xl font-bold mb-4 text-gray-900 dark:text-gray-100"},"Siparişlerim",-1)),e("div",se,[e("div",re,[t[2]||(t[2]=e("div",{class:"text-lg fw-semibold"},"Toplam Sipariş",-1)),e("div",le,r(d.totalOrders),1)]),e("div",oe,[t[3]||(t[3]=e("div",{class:"text-lg fw-semibold"},"Toplam Tutar",-1)),e("div",ie,r(o.formatCurrency(o.totalAmount)),1)])]),d.isLoading?(c(),n("div",ae,[...t[4]||(t[4]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Yükleniyor...")],-1),e("span",{class:"ms-2 fw-semibold"},"Siparişler yükleniyor...",-1)])])):(c(),n("div",de,[e("div",ne,[e("table",ce,[t[5]||(t[5]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Sipariş No"),e("th",null,"Toplam Tutar"),e("th",null,"Tarih"),e("th",null,"Detay")])],-1)),e("tbody",null,[(c(!0),n(h,null,g(d.orders,a=>(c(),n("tr",{key:a.order.id},[e("td",me,r(a.order.code),1),e("td",ue,r(o.formatCurrency(a.summary.overall)),1),e("td",null,r(o.formatDate(a.order.createdAt)),1),e("td",null,[e("button",{class:"btn btn-sm btn-info",onClick:v=>o.openModal(a)},"Detay",8,be)])]))),128))])])]),e("nav",he,[e("ul",ge,[e("li",{class:u(["page-item",d.currentPage===0?"disabled":""])},[e("button",{class:"page-link",onClick:t[0]||(t[0]=a=>o.goToPage(d.currentPage-1))},"«")],2),(c(!0),n(h,null,g(o.totalPages,a=>(c(),n("li",{key:a,class:u(["page-item",d.currentPage===a-1?"active":""])},[e("button",{class:"page-link",onClick:v=>o.goToPage(a-1)},r(a),9,ye)],2))),128)),e("li",{class:u(["page-item",d.currentPage===o.totalPages-1?"disabled":""])},[e("button",{class:"page-link",onClick:t[1]||(t[1]=a=>o.goToPage(d.currentPage+1))},"»")],2)])])])),p(i,{show:d.showModal,order:d.selectedOrder,onClose:o.closeModal},null,8,["show","order","onClose"])])}const ve=f(ee,[["render",fe]]);export{ve as default};
