import{_ as h,c as r,b as e,a as u,j as a,k as w,t as n,bD as f,n as b,F as g,r as p,g as m,o as i,d as y}from"./index-BFPoeHg0.js";const v={name:"Profil",data(){return{user:null,entegrasyonlar:[],editAd:"",editEmail:"",editTelefon:"",editEntegrasyonTelefon:"",oldPassword:"",newPassword:"",confirmNewPassword:"",savingPassword:!1,passwordSuccess:!1,passwordError:"",saving:!1,saveSuccess:!1,saveError:"",showOldPassword:!1,showNewPassword:!1,showConfirmPassword:!1,changingPassword:!1,changeSuccess:!1,changeError:""}},async mounted(){const l=localStorage.getItem("kullanici_id");if(l){try{const s=await m.get(`api/users/${l}`);this.user=s.data,this.editAd=s.data.ad||"",this.editEmail=s.data.email||"",this.editTelefon=s.data.telefon||"",this.editEntegrasyonTelefon=s.data.entegrasyon_Telefon||""}catch{this.user=null}try{const s=await m.get(`api/entegrasyonlar/by-user/${l}`);this.entegrasyonlar=Array.isArray(s.data)?s.data:s.data?[s.data]:[]}catch{this.entegrasyonlar=[]}}},methods:{maskKey(l){if(!l)return"";const s=l.slice(0,6),c="*".repeat(Math.max(l.length-6,0));return s+c},async updateUser(){this.saving=!0,this.saveSuccess=!1,this.saveError="";const l=localStorage.getItem("kullanici_id");try{let s=this.user.roller?.[0]?.rolId;const c={ad:this.editAd,email:this.editEmail,telefon:this.editTelefon,entegrasyon_Telefon:this.editEntegrasyonTelefon,telegramUseSamePhone:!1,...s&&{rolId:s}};await m.put(`api/users/${l}`,c),this.user={...this.user,...c},this.saveSuccess=!0}catch(s){console.error(s),this.saveError="Güncelleme başarısız."}finally{this.saving=!1,setTimeout(()=>{this.saveSuccess=!1},2e3)}},async changePassword(){if(!this.oldPassword||!this.newPassword||!this.confirmNewPassword){alert("Lütfen tüm alanları doldurun!");return}if(this.newPassword!==this.confirmNewPassword){alert("Yeni şifre ve tekrar şifre uyuşmuyor!");return}this.changingPassword=!0,this.changeSuccess=!1,this.changeError="";const l=localStorage.getItem("kullanici_id");try{const s=await m.post(`/api/users/change-password/${l}`,{oldPassword:this.oldPassword,newPassword:this.newPassword,confirmPassword:this.confirmNewPassword});alert("Şifre başarıyla değiştirildi!"),this.oldPassword="",this.newPassword="",this.confirmNewPassword="",this.changeSuccess=!0}catch(s){console.error(s),this.changeError=s.response?.data?.title||"Şifre değiştirilemedi!",alert(this.changeError)}finally{this.changingPassword=!1}}}},P={class:"container py-4"},_={key:0,class:"row g-4"},k={class:"col-md-6 d-flex"},E={class:"card shadow-sm w-100 h-100"},x={class:"card-body"},T={class:"mb-3"},S={class:"mb-3"},N={class:"mb-3"},I={class:"mb-3"},A=["disabled"],C={key:0,class:"text-success mt-2"},U={key:1,class:"text-danger mt-2"},K={class:"col-md-6 d-flex mt-4"},V={class:"card shadow-sm w-100"},D={class:"card-body"},B={class:"mb-3"},O={class:"input-group"},M=["type"],Y={class:"mb-3"},z={class:"input-group"},F=["type"],G={class:"mb-3"},L={class:"input-group"},R=["type"],j=["disabled"],q={key:0,class:"text-success mt-2"},H={key:1,class:"text-danger mt-2"},J={class:"col-12"},Q={class:"card shadow-sm w-100 h-100"},W={class:"card-body"},X={key:0},Z={class:"list-group list-group-flush"},$={class:"fw-bold mb-2"},ss={class:"mb-1"},es={class:"mb-1"},os={class:"mb-0"},ts={key:1,class:"alert alert-info text-center"},ls={key:1,class:"alert alert-warning text-center shadow-sm"};function rs(l,s,c,is,o,d){return i(),r("div",P,[s[28]||(s[28]=e("h2",{class:"text-center mb-4 fw-bold"},"Profilim",-1)),o.user?(i(),r("div",_,[e("div",k,[e("div",E,[s[17]||(s[17]=e("div",{class:"card-header bg-primary text-white"},[e("h5",{class:"mb-0"},"Kullanıcı Bilgileri")],-1)),e("div",x,[e("div",T,[s[12]||(s[12]=e("label",{class:"form-label"},[e("b",null,"Ad")],-1)),a(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.editAd=t),class:"form-control"},null,512),[[w,o.editAd]])]),e("div",S,[s[13]||(s[13]=e("label",{class:"form-label"},[e("b",null,"Email")],-1)),a(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>o.editEmail=t),type:"email",class:"form-control"},null,512),[[w,o.editEmail]])]),e("div",N,[s[14]||(s[14]=e("label",{class:"form-label"},[e("b",null,"Telefon")],-1)),a(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>o.editTelefon=t),class:"form-control"},null,512),[[w,o.editTelefon]])]),e("div",I,[s[15]||(s[15]=e("label",{class:"form-label"},[e("b",null,"Entegrasyon Telefon")],-1)),a(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>o.editEntegrasyonTelefon=t),class:"form-control",placeholder:"Telefon numarası girin"},null,512),[[w,o.editEntegrasyonTelefon]]),s[16]||(s[16]=e("small",{class:"text-muted"}," Sipariş ve Telegram entegrasyonunda kullanılacak telefon. ",-1))]),e("button",{class:"btn btn-success w-100",onClick:s[4]||(s[4]=(...t)=>d.updateUser&&d.updateUser(...t)),disabled:o.saving},n(o.saving?"Kaydediliyor...":"Kaydet"),9,A),o.saveSuccess?(i(),r("div",C,"✅ Bilgiler güncellendi!")):u("",!0),o.saveError?(i(),r("div",U,n(o.saveError),1)):u("",!0)])])]),e("div",K,[e("div",V,[s[21]||(s[21]=e("div",{class:"card-header bg-warning text-white"},[e("h5",{class:"mb-0"},"Şifre Değiştir")],-1)),e("div",D,[e("div",B,[s[18]||(s[18]=e("label",{class:"form-label"},"Eski Şifre",-1)),e("div",O,[a(e("input",{type:o.showOldPassword?"text":"password","onUpdate:modelValue":s[5]||(s[5]=t=>o.oldPassword=t),class:"form-control"},null,8,M),[[f,o.oldPassword]]),e("button",{class:"btn btn-outline-secondary",type:"button",onClick:s[6]||(s[6]=t=>o.showOldPassword=!o.showOldPassword)},[e("i",{class:b(o.showOldPassword?"bi bi-eye-slash":"bi bi-eye")},null,2)])])]),e("div",Y,[s[19]||(s[19]=e("label",{class:"form-label"},"Yeni Şifre",-1)),e("div",z,[a(e("input",{type:o.showNewPassword?"text":"password","onUpdate:modelValue":s[7]||(s[7]=t=>o.newPassword=t),class:"form-control"},null,8,F),[[f,o.newPassword]]),e("button",{class:"btn btn-outline-secondary",type:"button",onClick:s[8]||(s[8]=t=>o.showNewPassword=!o.showNewPassword)},[e("i",{class:b(o.showNewPassword?"bi bi-eye-slash":"bi bi-eye")},null,2)])])]),e("div",G,[s[20]||(s[20]=e("label",{class:"form-label"},"Yeni Şifre (Tekrar)",-1)),e("div",L,[a(e("input",{type:o.showConfirmPassword?"text":"password","onUpdate:modelValue":s[9]||(s[9]=t=>o.confirmNewPassword=t),class:"form-control"},null,8,R),[[f,o.confirmNewPassword]]),e("button",{class:"btn btn-outline-secondary",type:"button",onClick:s[10]||(s[10]=t=>o.showConfirmPassword=!o.showConfirmPassword)},[e("i",{class:b(o.showConfirmPassword?"bi bi-eye-slash":"bi bi-eye")},null,2)])])]),e("button",{class:"btn btn-warning w-100",onClick:s[11]||(s[11]=(...t)=>d.changePassword&&d.changePassword(...t)),disabled:o.savingPassword},n(o.savingPassword?"Kaydediliyor...":"Şifreyi Güncelle"),9,j),o.passwordSuccess?(i(),r("div",q,"✅ Şifre başarıyla güncellendi!")):u("",!0),o.passwordError?(i(),r("div",H,n(o.passwordError),1)):u("",!0)])])]),e("div",J,[e("div",Q,[s[27]||(s[27]=e("div",{class:"card-header bg-secondary text-white"},[e("h5",{class:"mb-0"},"Entegrasyonlarım")],-1)),e("div",W,[o.entegrasyonlar&&o.entegrasyonlar.length?(i(),r("div",X,[e("ul",Z,[(i(!0),r(g,null,p(o.entegrasyonlar,t=>(i(),r("li",{key:t.id,class:"list-group-item"},[e("h6",$,n(t.platformAdi||t.platform_Adi||"Platform"),1),e("p",ss,[s[22]||(s[22]=e("b",null,"API Key:",-1)),s[23]||(s[23]=y()),e("code",null,n(d.maskKey(t.api_Key)),1)]),e("p",es,[s[24]||(s[24]=e("b",null,"API Secret:",-1)),s[25]||(s[25]=y()),e("code",null,n(d.maskKey(t.api_Secret)),1)]),e("p",os,[s[26]||(s[26]=e("b",null,"Satıcı ID:",-1)),y(" "+n(t.seller_Id),1)])]))),128))])])):(i(),r("div",ts," Entegrasyon bulunamadı. "))])])])])):(i(),r("div",ls," Kullanıcı bilgisi yükleniyor... "))])}const as=h(v,[["render",rs],["__scopeId","data-v-54fcb4bd"]]);export{as as default};
