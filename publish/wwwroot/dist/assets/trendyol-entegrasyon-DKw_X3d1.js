import{_ as g,c as d,o as n,a as e,j as y,v as h,F as c,r as p,d as u,t as l,e as m,b}from"./index-DfLkNCfm.js";import{f}from"./format-nzxwg-s_.js";const x={data(){return{orders:[],selectedStatus:"",currentPage:1,pageSize:10,statusMap:{Created:"Oluşturuldu",Picking:"Hazırlanıyor",Invoiced:"Faturalandı",Shipped:"Kargoya Verildi",Cancelled:"İptal Edildi",Delivered:"Teslim Edildi",UnDelivered:"Teslim Edilemedi",Returned:"İade Edildi",Repack:"Tekrar Paketlenecek",UnSupplied:"Tedarik Edilemedi"},isLoading:!1}},computed:{filteredOrders(){return this.selectedStatus?this.orders.filter(r=>r.durum===this.selectedStatus):this.orders},totalPages(){return Math.ceil(this.filteredOrders.length/this.pageSize)||1},paginatedOrders(){const r=(this.currentPage-1)*this.pageSize;return this.filteredOrders.slice(r,r+this.pageSize)}},watch:{selectedStatus(){this.currentPage=1}},async mounted(){this.loadOrders(),this.pollingInterval=setInterval(this.loadOrders,5e3)},beforeUnmount(){clearInterval(this.pollingInterval)},methods:{async loadOrders(){try{this.isLoading=!0;const r=await m.get("http://localhost:5079/api/siparisler");this.orders=r.data}catch(r){console.error("Siparişler yüklenemedi",r)}finally{this.isLoading=!1}},async sendTelegram(r){try{(await m.post(`http://localhost:5079/api/entegrasyonlar/send-siparis-telegram/${r}`)).data.sent?(alert("Sipariş Mesaj olarak gönderildi!"),this.loadOrders()):alert("Gönderilemedi.")}catch(t){console.error(t),alert("Hata oluştu.")}},formatMoney(r,t){return f(r,t)},formatOrderDate(r){return new Date(r).toLocaleString("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}}},S={class:"mb-4"},v=["value"],k={class:"table-auto w-full border"},_={class:"border px-4 py-2"},T={class:"border px-4 py-2"},P={class:"border px-4 py-2"},O={class:"border px-4 py-2"},D={class:"border px-4 py-2"},M={class:"border px-4 py-2"},C=["onClick"],E={class:"d-flex items-align-center justify-content-center mt-4"},w={class:"flex space-x-2"},z=["disabled"],F=["disabled"];function N(r,t,I,L,a,i){return n(),d("div",null,[t[8]||(t[8]=e("h2",{class:"text-xl font-bold mb-4"},"Trendyol Siparişleri",-1)),e("div",S,[t[4]||(t[4]=e("label",{for:"statusFilter",class:"mr-2 font-semibold"},"Duruma Göre Filtrele:",-1)),y(e("select",{id:"statusFilter","onUpdate:modelValue":t[0]||(t[0]=s=>a.selectedStatus=s),class:"border px-3 py-2 rounded"},[t[3]||(t[3]=e("option",{value:""},"Tümü",-1)),(n(!0),d(c,null,p(a.statusMap,(s,o)=>(n(),d("option",{key:o,value:o},l(s),9,v))),128))],512),[[h,a.selectedStatus]])]),e("table",k,[t[7]||(t[7]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"border px-4 py-2"},"Sıra No"),e("th",{class:"border px-4 py-2"},"Sipariş No"),e("th",{class:"border px-4 py-2"},"Durum"),e("th",{class:"border px-4 py-2"},"Tarih"),e("th",{class:"border px-4 py-2"},"Toplam"),e("th",{class:"border px-4 py-2 text-center"},"Mesaj Durumu")])],-1)),e("tbody",null,[(n(!0),d(c,null,p(i.paginatedOrders,(s,o)=>(n(),d("tr",{key:s.id},[e("td",_,l((a.currentPage-1)*a.pageSize+o+1),1),e("td",T,l(s.siparisNumarasi),1),e("td",P,l(a.statusMap[s.durum]),1),e("td",O,l(i.formatOrderDate(s.createdAt)),1),e("td",D,l(i.formatMoney(s.toplamTutar,"TRY")),1),e("td",M,[u(l(s.telegramSent)+" ",1),s.telegramSent?b("",!0):(n(),d("button",{key:0,class:"btn btn-sm btn-primary",onClick:V=>i.sendTelegram(s.id)},"Gönder",8,C))])]))),128))]),e("tfoot",null,[e("div",null,[t[5]||(t[5]=u(" Toplam ",-1)),e("strong",null,l(i.filteredOrders.length),1),t[6]||(t[6]=u(" sipariş bulundu. ",-1))])])]),e("div",E,[e("div",w,[e("button",{class:"px-3 py-1 border rounded",disabled:a.currentPage===1,onClick:t[1]||(t[1]=s=>a.currentPage--)}," Önceki ",8,z),e("span",null,"Sayfa "+l(a.currentPage)+" / "+l(i.totalPages),1),e("button",{class:"px-3 py-1 border rounded",disabled:a.currentPage===i.totalPages,onClick:t[2]||(t[2]=s=>a.currentPage++)}," Sonraki ",8,F)])])])}const U=g(x,[["render",N]]);export{U as default};
